---
// src/components/cards/SampleCard/index.astro

export interface Media {
  src: string;
  alt?: string;
  width?: number;
  height?: number;
}

export interface Props {
  title: string;
  /**
   * Kept in the contract for the /samples modal.
   * Not rendered directly in the card â€“ used by the grid controller + modal only.
   */
  before: string;
  after: string;
  eyebrow?: string;
  subtitle?: string;
  compact?: boolean;
  media?: Media | null;
  ctaLabel?: string;
}

const {
  title,
  eyebrow = "Sample",
  subtitle,
  compact = false,
  media = null,
  ctaLabel = "View before / after",
} = Astro.props as Props;

const slug = title
  .toLowerCase()
  .replace(/[^a-z0-9]+/g, "-")
  .replace(/(^-|-$)/g, "");

const titleId = `samplecard-${slug || "title"}`;

// Fixed, static CSS asset import (Vite/Netlify friendly)
import sampleCardCss from "./SampleCard.css?url";
---

<link rel="stylesheet" href={sampleCardCss} />

<article
  class={`card samplecard${compact ? " samplecard--compact" : ""}`}
  data-section="samplecard"
  aria-labelledby={titleId}
>
  {media?.src && (
    <figure class="samplecard__media">
      <img
        src={media.src}
        alt={media.alt ?? title}
        width={media.width ?? 640}
        height={media.height ?? 360}
        loading="lazy"
        decoding="async"
        class="samplecard__img"
      />
    </figure>
  )}

  <div class="samplecard__body stack">
    <header class="samplecard__head">
      {eyebrow && <p class="samplecard__eyebrow">{eyebrow}</p>}

      <h3 id={titleId} class="h3 samplecard__title samplecard__title--clamp">
        {title}
      </h3>

      {subtitle && (
        <p class="samplecard__subtitle text-muted">
          {subtitle}
        </p>
      )}
    </header>

    <footer class="samplecard__footer">
      <button
        type="button"
        class="samplecard__cta btn btn-primary"
        aria-label={`View before and after for ${title}`}
        data-cta="samplecard-open"
      >
        {ctaLabel}
      </button>
    </footer>
  </div>
</article>
