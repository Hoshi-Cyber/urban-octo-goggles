---
// src/components/sections/about/AboutNextStepsSection/index.astro
import "./AboutNextStepsSection.css";

export interface NextStepLink {
  key: "pricing" | "services" | "samples" | "contact" | string;
  label: string;
  description: string;
  href: string;
  ctaLabel?: string;
}

export interface AboutNextStepsSectionProps {
  eyebrow?: string;
  title: string;
  intro?: string;
  links: NextStepLink[];
  headingLevel?: "h2" | "h3";
}

const {
  eyebrow,
  title,
  intro,
  links,
  headingLevel = "h2",
} = Astro.props as AboutNextStepsSectionProps;

type HeadingTag = "h2" | "h3";
const Heading = headingLevel as HeadingTag;

const sectionId =
  "about-next-steps-" +
  title
    .toLowerCase()
    .replace(/[^a-z0-9]+/g, "-")
    .replace(/(^-|-$)+/g, "");

// Clear, action-focused CTA labels per next-step key
const getCtaLabel = (link: NextStepLink): string => {
  if (link.ctaLabel) return link.ctaLabel;

  switch (link.key) {
    case "pricing":
      return "View pricing";
    case "services":
      return "Explore services";
    case "samples":
      return "Browse samples";
    case "contact":
      return "Talk to the team";
    default:
      return "Learn more";
  }
};
---

<section
  class="about-next-steps"
  aria-labelledby={sectionId}
  data-section="about-next-steps"
>
  <div class="container about-next-steps__inner stack">
    <header class="about-next-steps__header section-head">
      {eyebrow && (
        <p class="about-next-steps__eyebrow section-sub">
          {eyebrow}
        </p>
      )}

      <Heading
        id={sectionId}
        class={`section-title ${headingLevel === "h2" ? "h2" : "h3"}`}
      >
        {title}
      </Heading>

      {intro && (
        <p class="about-next-steps__intro section-sub">
          {intro}
        </p>
      )}
    </header>

    <div class="about-next-steps__content stack">
      {links && links.length > 0 && (
        <nav
          class="about-next-steps__nav"
          aria-label="Next steps after reading about this page"
        >
          <ul class="about-next-steps__links">
            {links.map((link) => (
              <li class="about-next-steps__links-item">
                <article
                  class="about-next-steps__link-card"
                  data-next-step-key={link.key}
                >
                  <span class="about-next-steps__link-label">
                    {link.label}
                  </span>

                  <span class="about-next-steps__link-description">
                    {link.description}
                  </span>

                  <a
                    href={link.href}
                    class="btn btn-primary btn-sm about-next-steps__link-cta"
                  >
                    {getCtaLabel(link)}
                  </a>
                </article>
              </li>
            ))}
          </ul>
        </nav>
      )}
    </div>
  </div>
</section>
