---
/*
  src/components/blog/post/RelatedArticles/index.astro

  RelatedArticles presentation strip (Fix Plan 006 Step 4.8)

  Responsibilities:
  - Present a small, reusable “related articles” band.
  - Remain UI-only: all selection logic lives in src/lib/blog/related.ts.
  - Avoid introducing additional landmarks so it can be nested inside
    BlogPostLayout’s own <section> wrapper without accessibility conflicts.
*/

import PostCard from "@/components/blog/compose/PostCard";
import postGridCss from "@/styles/components/PostGrid.css?url";

import "./RelatedArticles.css";

export interface RelatedArticle {
  title: string;
  href: string;
  category: string;
  readingTimeMinutes?: number;
  excerpt?: string;
  dateISO?: string;
}

export interface RelatedArticlesProps {
  items: RelatedArticle[];
  /**
   * Optional title for the strip heading.
   * Defaults to a generic “Related articles” label.
   */
  title?: string;
  /**
   * Band variant hook used by BlogPostLayout presets.
   * "tinted" keeps the soft band; "flat" prefers a neutral background.
   * The actual band background is owned by the parent band wrapper
   * (e.g. .blog-post-layout__related).
   */
  bandVariant?: "tinted" | "flat";
}

const {
  items,
  title = "Related articles",
  bandVariant = "tinted",
} = Astro.props as RelatedArticlesProps;

const hasItems = Array.isArray(items) && items.length > 0;
---

{hasItems && (
  <div
    class="related-articles"
    data-band-variant={bandVariant}
    aria-labelledby="related-articles-title"
  >
    <link rel="stylesheet" href={postGridCss} />

    <div class="related-articles__inner">
      <header class="related-articles__header">
        <h2
          id="related-articles-title"
          class="related-articles__title h2 section-title"
        >
          {title}
        </h2>
      </header>

      <ul class="post-grid related-articles__grid">
        {items.map((item) => (
          <li>
            <PostCard
              url={item.href}
              title={item.title}
              category={item.category}
              readMin={item.readingTimeMinutes}
              excerpt={item.excerpt}
              dateISO={item.dateISO}
            />
          </li>
        ))}
      </ul>
    </div>
  </div>
)}
