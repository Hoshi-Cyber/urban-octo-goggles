---
/*
  src/components/blog/post/RelatedArticles/index.astro

  Fix Plan 205.1.6 â€“ Implement RelatedArticles Selection Logic

  Responsibilities:
  - Pure presentation for the "Related articles" strip at the bottom of a post.
  - Consumes a pre-selected, deterministic items[] payload from:
      - src/lib/blog/related.getRelatedArticles (canonical helper), or
      - Legacy fallback mapping in src/components/blog/base/BlogPost.astro.
  - Renders a compact PostGrid using PostCard for each related article.

  Selection, scoring, and overrides (relatedPosts in frontmatter) are handled
  upstream. This component must remain display-only and accept items as-is.
*/

import PostCard from "@/components/blog/compose/PostCard";
import postGridCss from "@/styles/components/PostGrid.css?url";

import "./RelatedArticles.css";

export interface RelatedArticle {
  title: string;
  href: string;
  category: string;
  readingTimeMinutes?: number;
  /** Optional extras if available */
  excerpt?: string;
  dateISO?: string;
}

export interface RelatedArticlesProps {
  items: RelatedArticle[];
  title?: string;
  eyebrow?: string;
}

const {
  items,
  title = "Related articles",
  eyebrow = "Keep learning",
} = Astro.props as RelatedArticlesProps;

const hasItems = Array.isArray(items) && items.length > 0;
---

{hasItems && (
  <section
    class="related-articles"
    aria-labelledby="related-articles-title"
  >
    <link rel="stylesheet" href={postGridCss} />

    <header class="related-articles__header">
      {eyebrow && (
        <p class="related-articles__eyebrow">
          {eyebrow}
        </p>
      )}
      <h2
        id="related-articles-title"
        class="related-articles__title"
      >
        {title}
      </h2>
    </header>

    <ul class="post-grid related-articles__grid">
      {items.map((item) => (
        <li>
          <PostCard
            url={item.href}
            title={item.title}
            category={item.category}
            readMin={item.readingTimeMinutes}
            excerpt={item.excerpt}
            dateISO={item.dateISO}
          />
        </li>
      ))}
    </ul>
  </section>
)}
