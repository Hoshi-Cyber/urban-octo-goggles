---
import BaseLayout from "@/components/layout/BaseLayout.astro";
import Button from "@/components/cta/Button/index.astro";
import "./ServicePage.css";

const {
  title,
  description = "",
  hero = {},
  features = [],
  aside = {
    eyebrow: "Pricing",
    title: "Compare packages",
    body: "Transparent pricing for every career stage.",
    actions: [
      { href: "/pricing/", label: "View Packages" },
      { href: "/contact/", label: "Talk to us" },
    ],
  },
} = Astro.props;

const heroEyebrow = hero?.eyebrow;
const heroActions = Array.isArray(hero?.actions) ? hero.actions : [];

// Toggleable hero image (can be disabled with hero.disableImage === true)
const heroDisableImage = hero?.disableImage === true;
const heroHasImage = !heroDisableImage;

// Default hero image + alt, overrideable via hero.image / hero.imageAlt
const heroImage =
  hero?.image ?? "/assets/images/services/main-services-overview-hero.webp";
const heroImageAlt =
  hero?.imageAlt ??
  `${title || "CV writing service"} â€“ professional CV and career branding visual`;
---

<BaseLayout {title} {description}>
  <div class="servicePage stack page-gap-after" data-template="service-page">
    <!-- HERO -->
    <section class="section section--hero" aria-labelledby="service-hero">
      <div class="container servicePage__hero">
        <div class="servicePage__hero-content flow">
          {heroEyebrow && <p class="eyebrow">{heroEyebrow}</p>}

          <h1 id="service-hero" class="h1 servicePage__title">
            {title}
          </h1>

          {description && (
            <p class="sub page-lead">
              {description}
            </p>
          )}

          {heroActions.length > 0 && (
            <div class="cta-row">
              {heroActions.map((a) => (
                <Button
                  label={a.label}
                  href={a.href}
                  variant={a.variant ?? "primary"}
                  size={a.size ?? "md"}
                  cta={a.cta}
                  target={a.target}
                  rel={a.rel}
                />
              ))}
            </div>
          )}
        </div>

        {heroHasImage && (
          <div class="servicePage__hero-media">
            <div class="servicePage__hero-media-shell">
              <img
                class="servicePage__hero-image"
                src={heroImage}
                alt={heroImageAlt}
                width="1600"
                height="1200"
                loading="eager"
                decoding="async"
              />
            </div>
          </div>
        )}
      </div>
    </section>


   <!-- MAIN CONTENT + ASIDE -->
<section class="section section--balanced">
  <div class="container grid">
    <article class="content prose">
      <slot />
    </article>

    <aside class="aside" aria-label="Quick actions">
      <div class="card aside-card">
        <p class="eyebrow aside-eyebrow">
          {aside?.eyebrow ?? "Pricing"}
        </p>
        <h2 class="h3 card-title">
          {aside?.title ?? "Compare packages"}
        </h2>
        <p class="card-sub">
          {aside?.body ?? "Transparent pricing for every career stage."}
        </p>

        <div class="cta-col">
          <Button
            label={aside?.actions?.[0]?.label ?? "See Packages & Pricing"}
            href={aside?.actions?.[0]?.href ?? "/pricing/#pricing"}
            variant={aside?.actions?.[0]?.variant ?? "primary"}
            size={aside?.actions?.[0]?.size ?? "md"}
            block={true}
            cta={aside?.actions?.[0]?.cta ?? "service-aside-primary"}
            target={aside?.actions?.[0]?.target}
            rel={aside?.actions?.[0]?.rel}
          />
          <Button
            label={aside?.actions?.[1]?.label ?? "Start via WhatsApp"}
            href={
              aside?.actions?.[1]?.href ??
              `https://wa.me/254115117501?text=Hi%20CVWriting.co.ke,%20I%E2%80%99m%20interested%20in%20your%20CV%20writing%20service.%0A%0ASource:%20${encodeURIComponent(
                Astro.url.pathname
              )}%0ACTA:%20aside-secondary%0A%0AWhat%20should%20I%20send%20first%20to%20get%20started%3F`
            }
            variant={aside?.actions?.[1]?.variant ?? "ghost"}
            size={aside?.actions?.[1]?.size ?? "md"}
            block={true}
            cta={aside?.actions?.[1]?.cta ?? "service-aside-secondary"}
            target={aside?.actions?.[1]?.target}
            rel={aside?.actions?.[1]?.rel}
          />
        </div>
      </div>
    </aside>
  </div>
</section>

<!-- Optional band(s) between main content and features -->
<slot name="after-main" />

<!-- FEATURES -->
{Array.isArray(features) && features.length > 0 && (
  <section
    class="section section--tight"
    aria-labelledby="service-features"
  >
    <div class="container">
      <div class="features">
        {features.map((f) => (
          <article class="feature">
            <h3 class="h3 feature-title">
              {f.title}
            </h3>
            <p class="feature-body">
              {f.body}
            </p>
          </article>
        ))}
      </div>
    </div>
  </section>
)}
</div>
</BaseLayout>

