---
import BaseLayout from "@/components/layout/BaseLayout.astro";
import Button from "@/components/cta/Button/index.astro";
import "./ServicePage.css";

const {
  title,
  description = "",
  hero = {},
  features = [],
  aside = {
    eyebrow: "Pricing",
    title: "Compare packages",
    body: "Transparent pricing for every career stage.",
    actions: [
      { href: "/pricing/", label: "View Packages" },
      { href: "/contact/", label: "Talk to us" },
    ],
  },
} = Astro.props;

const heroEyebrow = hero?.eyebrow;
const heroActions = Array.isArray(hero?.actions) ? hero.actions : [];

// Toggleable hero image (can be disabled with hero.disableImage === true)
const heroDisableImage = hero?.disableImage === true;
const heroHasImage = !heroDisableImage;

// Default hero image + alt, overrideable via hero.image / hero.imageAlt
const heroImage =
  hero?.image ?? "/assets/images/services/main-services-overview-hero.webp";
const heroImageAlt =
  hero?.imageAlt ??
  `${title || "CV writing service"} â€“ professional CV and career branding visual`;
---

<BaseLayout {title} {description}>
  <div class="servicePage stack page-gap-after" data-template="service-page">
    <!-- HERO -->
    <section class="section section--hero" aria-labelledby="service-hero">
      <div class="container servicePage__hero">
        <div class="servicePage__hero-content flow">
          {heroEyebrow && <p class="eyebrow">{heroEyebrow}</p>}

          <h1 id="service-hero" class="h1 servicePage__title">
            {title}
          </h1>

          {description && (
            <p class="sub page-lead">
              {description}
            </p>
          )}

          {heroActions.length > 0 && (
            <div class="cta-row">
              {heroActions.map((a) => (
                <Button
                  label={a.label}
                  href={a.href}
                  variant="primary"
                  size="md"
                />
              ))}
            </div>
          )}
        </div>

        {heroHasImage && (
          <div class="servicePage__hero-media">
            <div class="servicePage__hero-media-shell">
              <img
                class="servicePage__hero-image"
                src={heroImage}
                alt={heroImageAlt}
                width="1600"
                height="1200"
                loading="eager"
                decoding="async"
              />
            </div>
          </div>
        )}
      </div>
    </section>

    <!-- MAIN CONTENT + ASIDE -->
    <section class="section section--balanced">
      <div class="container grid">
        <article class="content prose">
          <slot />
        </article>

        <aside class="aside" aria-label="Quick actions">
          <div class="card aside-card">
            <p class="eyebrow aside-eyebrow">
              {aside.eyebrow}
            </p>
            <h2 class="h3 card-title">
              {aside.title}
            </h2>
            <p class="card-sub">
              {aside.body}
            </p>

            <div class="cta-col">
              <Button
                label={aside.actions?.[0]?.label ?? "View Packages"}
                href={aside.actions?.[0]?.href ?? "/pricing/"}
                variant="primary"
                size="md"
                block={true}
                cta="service-aside-primary"
              />
              <Button
                label={aside.actions?.[1]?.label ?? "Talk to us"}
                href={aside.actions?.[1]?.href ?? "/contact/"}
                variant="ghost"
                size="md"
                block={true}
                cta="service-aside-secondary"
              />
            </div>
          </div>
        </aside>
      </div>
    </section>

    <!-- FEATURES -->
    {Array.isArray(features) && features.length > 0 && (
      <section
        class="section section--tight"
        aria-labelledby="service-features"
      >
        <div class="container">
          <div class="features">
            {features.map((f) => (
              <article class="feature">
                <h3 class="h3 feature-title">
                  {f.title}
                </h3>
                <p class="feature-body">
                  {f.body}
                </p>
              </article>
            ))}
          </div>
        </div>
      </section>
    )}
  </div>
</BaseLayout>
